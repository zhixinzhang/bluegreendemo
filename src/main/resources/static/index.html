<!DOCTYPE HTML>
<html>
<head> 
    <title>Getting Started: Serving Web Content</title> 
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>
    <img src="https://images6.alphacoders.com/113/1131919.jpg" style="width:480px;height:270px;">
    <h1>Let's start the Blizzard Blue and Green Deployment Demo </h1>
    <h2>Currently we are running on new Blue Environment (Prod) </h2>
    
    <button type="button"
        onclick="document.getElementById('demoCurrentTime').innerHTML = Date()">
        Click me to display Date and Time. (not api call)</button>

    <p id="demoCurrentTime"></p>

    <input type="button" value="check current date/time backend API Call" onclick="location.href = '/bluegreenapi'" />

    <p>Click the button to call api 2 times per second in total 30 seconds</p>
    <p><a href="https://github.com/zhixinzhang/bluegreendemo/blob/main/src/test/java/com/blizzard/bluegreendemo/BlueGreenTest.java">
        More powerful appliction test see BlueGreenTest</a></p>
    <button onclick="testApiApplication()">List time spots</button>

    <div id = 'target'>
    </div>
    <script>
        async function testApiApplication() {
            try {
                
                var target = document.getElementById("target");
                document.getElementById("target").innerHTML = "";
                for (let i = 0; i < 30; i++) {
                    await new Promise(resolve => setTimeout(resolve, 500));
                    displayDate(target);
                }
                
            } catch (error) {
                console.error(error);
            }
        }   
         async function displayDate(target) {
            try {
                const response = await fetch('/bluegreenapi');
                const data = await response.json();
                console.log(JSON.stringify(data));
                var p = document.createElement("p");
                var textNode = document.createTextNode(JSON.stringify(data));
                p.appendChild(textNode);
                target.appendChild(p);
            } catch (error) {
                console.error(error);
            }
        }      
    </script>

    <p id="xTimes"></p>
</body>
</html>